package s6.suiviRegime.service;
import s6.suiviRegime.dao.HibernateDao;
import s6.suiviRegime.modele.Poids;
import s6.suiviRegime.modele.Regime;
import s6.suiviRegime.modele.Utilisateur;

public class RegimeService {
	private HibernateDao dao;
	private RegimeService(){
		if(dao == null) dao = new HibernateDao();
	}
	private static class Holder
	{		
		private final static RegimeService instance = new RegimeService();
	}
	public static RegimeService getInstance(){
		return Holder.instance;
	}
	public void addRegime(Utilisateur utilisateur, String debut, String fin, String poidsObjectif) throws Exception{
			Regime regime = new Regime();
			regime.setUtilisateur(utilisateur);
			regime.setDebut(debut);
			regime.setFin(fin);
			regime.setPoidsObjectif(poidsObjectif);
			dao.save(regime);
	}
	public void addRegime(String utilisateur, String debut, String fin, String poidsObjectif) throws Exception{
		try{
			int id = Integer.parseInt(utilisateur.trim());
			Utilisateur u = new Utilisateur(id);
			dao.findById(u);
			addRegime(u, debut, fin, poidsObjectif);
		}catch(NumberFormatException e){
			throw new Exception("Utilisateur introuvable, valeur incorrect");
		}
	}
	public void addPoids(String poids, String date, Regime regime) throws Exception{
		Poids p = new Poids();
		p.setRegime(regime);
		p.setDate(date);
		p.setValeur(poids);
		dao.save(p);
	}
	public void addPoids(String poids, String date, String regime) throws Exception{
		addPoids(getRegime(regime));
	}
	public void addAlimentation(Regime regime, String repas, String boisson, int periode, String date) {
		
	}
	public void addAlimentation(String regime, String repas, String boisson, int periode, String date) {
		
	}
	public Regime getRegime(String regime) throws Exception{
		try{
			Regime r = new Regime(Integer.parseInt(regime.trim()));
			dao.findById(r);
			return r;
		}catch(NumberFormatException e){
			throw new Exception("Utilisateur introuvable, valeur incorrect");
		}
	}
}
